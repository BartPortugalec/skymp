# Теги

`[DOCS]` Изменения в текстовых файлах, предназначенных для чтения человеком (ридми, документация).
`[INTERNAL]` Изменение настроек сборки, исправление ошибок сборки, изменения разных скриптах, в том числе в **генерации документации** и прочие изменения, не затрагивающие код, выполняющийся на конечной машине, **кроме автотестов**.
`[TESTS]` Изменения в автотестах.
`[REFACT]` Изменения в коде, не затрагивающие функциональность.
`[OPTIMIZE]` Изменения в коде с целью повышения производительности.
`[MAJOR]` Тег ставится, когда в коммите сделаны обратно несовместимые изменения API.
`[MINOR]` Тег ставится, когда вы добавляете новую функциональность, не нарушая обратной совместимости.
`[FIX]` Тег ставится, когда коммит исправляет баг или краш.

## Список доступных комбинаций

Никаким другим образом теги комбинировать нельзя.

`[DOCS]`
`[INTERNAL]`
`[TESTS]`
`[REFACT]`
`[OPTIMIZE]`
`[MAJOR]`
`[MINOR]`
`[FIX]`

## Закрытие issue коммитом

Если для бага или улучшения, которое делается коммитом существует открытый issue, то коммит должен называться по форме `[TAG1][TAG2] My awesome commit (close #108)`

## Примеры

`[FIX] Crash in ObjectReference::СlearDestruction (close #108)` - Исправили краш при вызове функции ObjectReference.clearDestruction.

`[OPTIMIZE] Function search (close #108)` - Улучшили поиск функций в плане скорости работы.

`[REFACT] Function search (close #108)` - Улучшили поиск функций в плане внешнего вида кода.

## Протокол действий при нарушении версионирования

### Мажорная версия

Если обратная совместимость была нарушена коммитом, не имеющим тега `[MAJOR]`, то такое нарушение считается багом.

- Делается исправление коммитом с тегом `[FIX]`, восстанавливающее совместимость.
- Выпускается пустой коммит `[MAJOR] Bump major version`. Тем самым мы признаём, что мы хотели сломать совместимость, но забыли поставить тег `[MAJOR]` ранее.

### Минорная версия

- Выпускается пустой коммит `[MINOR] Bump minor version`

## Выпуск версий

Каждую пятницу в 23:59 делается коммит вида `[PUBLISH] Stable 1.2.3`, на него ставится тег, соответствующий версии, напр., `1.2.3`, после чего он пушится в master.

Если никаких коммитов с предыдущего `[PUBLISH] ...` не последовало, то новая версия не публикуется (пропускается неделя).

В skymp можно использовать только версии платформы вида `1.2.3`, без хеша коммита и т.д. Если в skymp нужно срочно обновить платформу, выпускается коммит вида `[PUBLISH] Hotfix 1.2.3` в ручном режиме:

1.  `git commit --allow-empty`
2.  `git tag 1.2.3`
3.  `git push origin 1.2.3`
4.  `git push origin master`
